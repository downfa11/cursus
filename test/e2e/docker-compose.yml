services:  
  broker:    
    build:    
      context: ../..    
      dockerfile: Dockerfile
    container_name: broker    
    command: ./broker    
    volumes:    
      - ../config.yaml:/root/config.yaml    
    environment:    
      - CONFIG_PATH=/root/config.yaml    
    ports:    
      - "10000:9000"    
      - "10100:9100"    
      - "10080:9080"    
    stdin_open: true    
    tty: true    
    networks:    
      - test_network  
    healthcheck:    
      test: ["CMD", "curl", "-f", "http://localhost:9080/health"]    
      interval: 10s    
      timeout: 5s    
      retries: 5    
  
networks:  
  test_network:  
    name: test_network
    driver: bridge  
  
volumes:  
  broker-data: